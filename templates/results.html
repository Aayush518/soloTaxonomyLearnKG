{% extends "base.html" %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <!-- Results Header -->
    <div class="text-center mb-16">
        <div class="floating-element mb-6">
            <h1 class="text-7xl font-black text-gray-900 mb-8 drop-shadow-2xl">Quiz Complete!</h1>
        </div>
        <div class="text-9xl mb-8 animate-bounce">
            {% if percentage >= 80 %}ðŸ†
            {% elif percentage >= 60 %}ðŸŽ‰
            {% else %}ðŸ’ª
            {% endif %}
        </div>
        <div class="text-6xl font-black text-gray-900 mb-6 drop-shadow-lg">{{ score }} / {{ total_questions }}</div>
        <div class="text-4xl text-gray-800 font-bold">{{ "%.1f"|format(percentage) }}% Correct</div>
    </div>

    <!-- Performance Cards -->
    <div class="grid md:grid-cols-3 gap-10 mb-16">
        <div class="stats-card p-10 text-center">
            <div class="text-6xl font-black text-orange-600 mb-6">{{ score }}</div>
            <div class="text-gray-700 text-2xl font-semibold">Questions Correct</div>
            <div class="w-full bg-gray-200 rounded-full h-4 mt-6">
                <div class="bg-gradient-to-r from-orange-400 to-yellow-400 h-4 rounded-full transition-all duration-1500" style="width: {{ (score / total_questions) * 100 }}%"></div>
            </div>
        </div>
        <div class="stats-card p-10 text-center">
            <div class="text-6xl font-black text-green-600 mb-6">{{ total_questions }}</div>
            <div class="text-gray-700 text-2xl font-semibold">Total Questions</div>
            <div class="w-full bg-gray-200 rounded-full h-4 mt-6">
                <div class="bg-gradient-to-r from-green-400 to-lime-400 h-4 rounded-full" style="width: 100%"></div>
            </div>
        </div>
        <div class="stats-card p-10 text-center">
            <div class="text-6xl font-black text-teal-600 mb-6">{{ "%.0f"|format(percentage) }}%</div>
            <div class="text-gray-700 text-2xl font-semibold">Success Rate</div>
            <div class="w-full bg-gray-200 rounded-full h-4 mt-6">
                <div class="bg-gradient-to-r from-teal-400 to-green-400 h-4 rounded-full transition-all duration-1500" style="width: {{ percentage }}%"></div>
            </div>
        </div>
    </div>

    <!-- SOLO Performance Analysis -->
    <div class="quiz-card p-12 mb-16">
        <h2 class="text-4xl font-bold mb-10 text-center text-gray-900">SOLO Taxonomy Performance</h2>
        <div class="grid md:grid-cols-5 gap-8">
            {% for level, performance in solo_performance.items() %}
            <div class="text-center group">
                <div class="solo-badge {{ 'solo-' + level.lower().replace('-', '').replace(' ', '') }} mb-6 group-hover:scale-125 transition-transform duration-500">
                    {{ level }}
                </div>
                <div class="text-4xl font-bold text-gray-900 mb-3">{{ performance.correct }}/{{ performance.total }}</div>
                <div class="text-xl text-gray-700 mb-6">{{ "%.0f"|format(performance.percentage) }}%</div>
                <div class="w-full bg-gray-200 rounded-full h-4">
                    <div class="bg-gradient-to-r from-yellow-400 to-orange-400 h-4 rounded-full transition-all duration-1500" style="width: {{ performance.percentage }}%"></div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- AI Analysis -->
    {% if ai_analysis %}
    <div class="quiz-card bg-white p-12 mb-16 border-2 border-gray-200">
        <div class="flex items-center mb-8">
            <i class="fas fa-robot text-5xl mr-6 text-orange-600"></i>
            <h2 class="text-4xl font-bold text-gray-900">AI Learning Analysis</h2>
        </div>
        <div class="prose prose-xl max-w-none text-gray-800 leading-relaxed">
            {{ ai_analysis | replace('\n', '<br>') | safe }}
        </div>
    </div>
    {% endif %}

    <!-- Learning Insights -->
    <div class="quiz-card p-12 mb-16">
        <h2 class="text-4xl font-bold mb-10 text-gray-800">Learning Insights</h2>
        <div class="space-y-8">
            {% if percentage >= 80 %}
            <div class="bg-gradient-to-r from-green-50 to-emerald-50 border-l-6 border-green-400 p-8 rounded-3xl">
                <div class="flex items-center mb-4">
                    <i class="fas fa-star text-4xl mr-4 text-green-600"></i>
                    <h3 class="font-bold text-green-800 text-2xl">Excellent Performance!</h3>
                </div>
                <p class="text-green-700 text-xl leading-relaxed">You demonstrate strong understanding across SOLO levels. Consider exploring advanced KG applications or helping others learn.</p>
            </div>
            {% elif percentage >= 60 %}
            <div class="bg-gradient-to-r from-yellow-50 to-orange-50 border-l-6 border-yellow-400 p-8 rounded-3xl">
                <div class="flex items-center mb-4">
                    <i class="fas fa-chart-line text-4xl mr-4 text-yellow-600"></i>
                    <h3 class="font-bold text-yellow-800 text-2xl">Good Progress!</h3>
                </div>
                <p class="text-yellow-700 text-xl leading-relaxed">You're developing solid KG knowledge. Focus on connecting concepts across different levels for deeper understanding.</p>
            </div>
            {% else %}
            <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border-l-6 border-blue-400 p-8 rounded-3xl">
                <div class="flex items-center mb-4">
                    <i class="fas fa-rocket text-4xl mr-4 text-blue-600"></i>
                    <h3 class="font-bold text-blue-800 text-2xl">Building Foundation</h3>
                </div>
                <p class="text-blue-700 text-xl leading-relaxed">Great start! Focus on understanding fundamental concepts before moving to complex applications. Practice makes perfect!</p>
            </div>
            {% endif %}
            
            <!-- Specific SOLO Level Recommendations -->
            {% for level, performance in solo_performance.items() %}
                {% if performance.total > 0 and performance.percentage < 60 %}
                <div class="bg-gradient-to-r from-gray-50 to-slate-50 border-l-6 border-gray-400 p-8 rounded-3xl">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-bullseye text-3xl mr-4 text-gray-600"></i>
                        <h3 class="font-bold text-gray-800 text-xl">Improve {{ level }} Skills</h3>
                    </div>
                    <p class="text-gray-700 text-lg leading-relaxed">
                        {% if level == 'Pre-structural' %}
                        Work on identifying and correcting common misconceptions about Knowledge Graphs.
                        {% elif level == 'Uni-structural' %}
                        Focus on memorizing key definitions and basic concepts.
                        {% elif level == 'Multi-structural' %}
                        Practice listing and categorizing multiple KG components and features.
                        {% elif level == 'Relational' %}
                        Work on understanding how different KG concepts connect and relate to each other.
                        {% elif level == 'Extended Abstract' %}
                        Practice applying KG knowledge to solve real-world problems and novel scenarios.
                        {% endif %}
                    </p>
                </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <!-- Next Steps -->
    <div class="flex flex-col sm:flex-row gap-8 justify-center">
        <a href="{{ url_for('home') }}" class="btn-primary text-center min-w-[250px]">
            <span class="flex items-center justify-center">
                <i class="fas fa-redo text-2xl mr-4"></i>
                Take Quiz Again
            </span>
        </a>
        <a href="{{ url_for('progress') }}" class="glass-card text-gray-800 px-10 py-5 text-lg font-bold border-2 border-gray-300 hover:border-purple-400 transform hover:scale-110 transition-all duration-400 shadow-2xl text-center min-w-[250px]">
            <span class="flex items-center justify-center">
                <i class="fas fa-chart-bar text-2xl mr-4"></i>
                View Progress
            </span>
        </a>
        <a href="{{ url_for('admin') }}" class="glass-effect text-white px-10 py-5 text-lg font-bold hover:bg-white/20 transform hover:scale-110 transition-all duration-400 shadow-2xl text-center min-w-[250px] border-2 border-white/30">
            <span class="flex items-center justify-center">
                <i class="fas fa-user-graduate text-2xl mr-4"></i>
                Educator Mode
            </span>
        </a>
    </div>
</div>

<script>
// Add entrance animations
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.quiz-card');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(50px)';
        setTimeout(() => {
            card.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 300);
    });
    
    // Animate progress bars
    setTimeout(() => {
        const progressBars = document.querySelectorAll('.h-4.bg-gradient-to-r');
        progressBars.forEach(bar => {
            const width = bar.style.width;
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.width = width;
            }, 800);
        });
    }, 1500);
});
</script>
{% endblock %}